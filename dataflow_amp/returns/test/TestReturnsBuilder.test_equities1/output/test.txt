################################################################################
config
################################################################################
load_prices:
  source_node_name: disk
  source_node_kwargs:
    file_path: s3://alphamatic-data/data/kibot/pq/sp_500_1min/AAPL.pq
    start_date: 2010-01-04 09:30:00
    end_date: 2010-01-04 16:05:00
filter_weekends:
  col_mode: replace_all
filter_ath:
  col_mode: replace_all
  transformer_kwargs:
    start_time: 09:30:00
    end_time: 16:00:00
resample_prices_to_1min:
  func_kwargs:
    rule: 1T
    price_cols: ['close']
    volume_cols: ['vol']
compute_vwap:
  rule: 5T
  price_col: close
  volume_col: vol
compute_ret_0:
  cols: ['twap', 'vwap']
  col_mode: merge_all
  transformer_kwargs:
    mode: pct_change
################################################################################
df_out
################################################################################
                          vwap    twap  twap_ret_0  vwap_ret_0
datetime                                                      
2010-01-04 09:30:00        NaN     NaN         NaN         NaN
2010-01-04 09:35:00  26.354942  26.350         NaN         NaN
2010-01-04 09:40:00  26.406202  26.408    0.002201    0.001945
2010-01-04 09:45:00  26.423782  26.426    0.000682    0.000666
2010-01-04 09:50:00  26.343312  26.352   -0.002800   -0.003045
2010-01-04 09:55:00  26.287632  26.290   -0.002353   -0.002114
2010-01-04 10:00:00  26.321200  26.318    0.001065    0.001277
2010-01-04 10:05:00  26.335235  26.336    0.000684    0.000533
2010-01-04 10:10:00  26.271883  26.276   -0.002278   -0.002406
2010-01-04 10:15:00  26.279456  26.276    0.000000    0.000288
2010-01-04 10:20:00  26.269847  26.278    0.000076   -0.000366
2010-01-04 10:25:00  26.261252  26.258   -0.000761   -0.000327
2010-01-04 10:30:00  26.344942  26.346    0.003351    0.003187
2010-01-04 10:35:00  26.349885  26.350    0.000152    0.000188
2010-01-04 10:40:00  26.353431  26.350    0.000000    0.000135
2010-01-04 10:45:00  26.354566  26.354    0.000152    0.000043
2010-01-04 10:50:00  26.352881  26.354    0.000000   -0.000064
2010-01-04 10:55:00  26.382736  26.378    0.000911    0.001133
2010-01-04 11:00:00  26.354353  26.358   -0.000758   -0.001076
2010-01-04 11:05:00  26.330467  26.332   -0.000986   -0.000906
2010-01-04 11:10:00  26.316017  26.318   -0.000532   -0.000549
2010-01-04 11:15:00  26.313482  26.314   -0.000152   -0.000096
2010-01-04 11:20:00  26.313599  26.316    0.000076    0.000004
2010-01-04 11:25:00  26.334501  26.334    0.000684    0.000794
2010-01-04 11:30:00  26.334982  26.336    0.000076    0.000018
2010-01-04 11:35:00  26.364641  26.360    0.000911    0.001126
2010-01-04 11:40:00  26.380000  26.380    0.000759    0.000583
2010-01-04 11:45:00  26.371067  26.374   -0.000227   -0.000339
2010-01-04 11:50:00  26.396647  26.386    0.000455    0.000970
2010-01-04 11:55:00  26.407131  26.406    0.000758    0.000397
2010-01-04 12:00:00  26.400000  26.400   -0.000227   -0.000270
2010-01-04 12:05:00  26.397102  26.398   -0.000076   -0.000110
2010-01-04 12:10:00  26.388294  26.392   -0.000227   -0.000334
2010-01-04 12:15:00  26.399993  26.398    0.000227    0.000443
2010-01-04 12:20:00  26.415345  26.410    0.000455    0.000582
2010-01-04 12:25:00  26.425638  26.426    0.000606    0.000390
2010-01-04 12:30:00  26.440000  26.440    0.000530    0.000543
2010-01-04 12:35:00  26.436388  26.434   -0.000227   -0.000137
2010-01-04 12:40:00  26.432127  26.434    0.000000   -0.000161
2010-01-04 12:45:00  26.441499  26.438    0.000151    0.000355
2010-01-04 12:50:00  26.439334  26.440    0.000076   -0.000082
2010-01-04 12:55:00  26.432499  26.432   -0.000303   -0.000259
2010-01-04 13:00:00  26.420052  26.422   -0.000378   -0.000471
2010-01-04 13:05:00  26.385482  26.386   -0.001363   -0.001308
2010-01-04 13:10:00  26.394258  26.394    0.000303    0.000333
2010-01-04 13:15:00  26.396256  26.396    0.000076    0.000076
2010-01-04 13:20:00  26.412359  26.410    0.000530    0.000610
2010-01-04 13:25:00  26.418148  26.416    0.000227    0.000219
2010-01-04 13:30:00  26.403576  26.404   -0.000454   -0.000552
2010-01-04 13:35:00  26.396923  26.398   -0.000227   -0.000252
2010-01-04 13:40:00  26.398492  26.398    0.000000    0.000059
2010-01-04 13:45:00  26.391919  26.392   -0.000227   -0.000249
2010-01-04 13:50:00  26.384055  26.384   -0.000303   -0.000298
2010-01-04 13:55:00  26.373755  26.372   -0.000455   -0.000390
2010-01-04 14:00:00  26.366539  26.366   -0.000228   -0.000274
2010-01-04 14:05:00  26.370000  26.370    0.000152    0.000131
2010-01-04 14:10:00  26.389240  26.386    0.000607    0.000730
2010-01-04 14:15:00  26.387457  26.390    0.000152   -0.000068
2010-01-04 14:20:00  26.401639  26.402    0.000455    0.000537
2010-01-04 14:25:00  26.393180  26.396   -0.000227   -0.000320
2010-01-04 14:30:00  26.383225  26.382   -0.000530   -0.000377
2010-01-04 14:35:00  26.404427  26.404    0.000834    0.000804
2010-01-04 14:40:00  26.405131  26.404    0.000000    0.000027
2010-01-04 14:45:00  26.437767  26.438    0.001288    0.001236
2010-01-04 14:50:00  26.437200  26.436   -0.000076   -0.000021
2010-01-04 14:55:00  26.437779  26.438    0.000076    0.000022
2010-01-04 15:00:00  26.421552  26.422   -0.000605   -0.000614
2010-01-04 15:05:00  26.433334  26.432    0.000378    0.000446
2010-01-04 15:10:00  26.447271  26.446    0.000530    0.000527
2010-01-04 15:15:00  26.433506  26.432   -0.000529   -0.000520
2010-01-04 15:20:00  26.450425  26.446    0.000530    0.000640
2010-01-04 15:25:00  26.454208  26.454    0.000303    0.000143
2010-01-04 15:30:00  26.434843  26.434   -0.000756   -0.000732
2010-01-04 15:35:00  26.442434  26.444    0.000378    0.000287
2010-01-04 15:40:00  26.433823  26.434   -0.000378   -0.000326
2010-01-04 15:45:00  26.425023  26.426   -0.000303   -0.000333
2010-01-04 15:50:00  26.447729  26.446    0.000757    0.000859
2010-01-04 15:55:00  26.452012  26.452    0.000227    0.000162
2010-01-04 16:00:00  26.442146  26.440   -0.000454   -0.000373
2010-01-04 16:05:00        NaN     NaN         NaN         NaN
