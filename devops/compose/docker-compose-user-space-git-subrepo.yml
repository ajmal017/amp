version: '3'

services:
  user_space:
    image: $IMAGE
    restart: "no"
    environment:
      - AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID
      - AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY
      - AWS_DEFAULT_REGION: $AWS_DEFAULT_REGION
    volumes:
      # Move one dir up to include the entire git repo (see AmpTask1017).
      - ../../../:/app
      - ~/.aws:/root/.aws
      - ~/.config/gspread_pandas/:/root/.config/gspread_pandas
      # No need to mount file systems.
      #- ../docker_build/fstab:/etc/fstab
    # Move one dir down to include the entire git repo (see AmpTask1017).
    working_dir: /app/amp
    privileged: true
    cap_add:
      - SYS_ADMIN
