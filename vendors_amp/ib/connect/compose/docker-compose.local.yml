version: '3'
services:
  tws:
    image: ${IMAGE}
    volumes:
      - ../../../../:/amp
      - ../vnc/xvfb_init:/etc/init.d/xvfb
      - ../vnc/vnc_init:/etc/init.d/vnc
      - ../vnc/xvfb-daemon-run:/usr/bin/xvfb-daemon-run
    entrypoint: "vendors_amp/ib/connect/entrypoint.sh"
    environment:
      - APP=${IB_APP}
      - VNC_PASSWORD=${VNC_PASSWORD}
      - TRUSTED_IPS=${TRUSTED_IPS}
      - VNC_PORT=${VNC_PORT}
      - API_PORT=${API_PORT}
    env_file:
      - ~/.vnc/ib.credentials
      - ../.env/local.env
    ports:
      - "${VNC_PORT}:${VNC_PORT}"
      - "${API_PORT}:${API_PORT}"
